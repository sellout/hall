{-|
Generates a conditional expression in Cabal.
-}
let Pvp = ../../PVP/package.dhall

let Conditional = ./Type

in  λ(a : Type) →
    λ(comparator : Text) →
    λ(ghcVersion : Pvp.Version) →
    λ(body : a) →
    λ(alt : a) →
      { condition =
          "impl(ghc " ++ comparator ++ " " ++ Pvp.show ghcVersion ++ ")"
      , `then` = body
      , `else` = alt
      }
