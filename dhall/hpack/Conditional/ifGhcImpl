{-|
Generates a conditional expression in Cabal.
-}
let Pvp = ../../PVP/package.dhall

let Conditional = ./Type

in  λ(a : Type) →
    λ(comparator : Text) →
    λ(ghcVersion : Pvp.Version) →
    λ(body : a) →
    λ(alt : Optional a) →
      let condition =
            "impl(ghc " ++ comparator ++ " " ++ Pvp.show ghcVersion ++ ")"

      in  merge
            { None = (Conditional a).When { condition, fields = body }
            , Some =
                λ(els : a) →
                  (Conditional a).If { condition, `then` = body, `else` = els }
            }
            alt
