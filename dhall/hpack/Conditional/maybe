{-|
Generates a conditional expression in Cabal _only_ if there the
`minimumGhcVersion` is less than the version it’s conditinolazed on.

__TODO__: If this doesn’t create the conditional, then the caller needs to
          manually add the `body` to the containing section.
-}
let Pvp = ../../PVP/package.dhall

let Conditional = ./Type

in  λ(a : Type) →
    λ(minimumGhcVersion : Pvp.Version) →
    λ(comparator : Text) →
    λ(ghcVersion : Pvp.Version) →
    λ(body : a) →
    λ(alt : a) →
      if    Pvp.lessThanEqual ghcVersion minimumGhcVersion
      then  [] : List (Conditional a)
      else  [ ./ifGhcImpl a comparator ghcVersion body alt ]
